<!-- <!DOCTYPE html>
<html>
<head>
    <title>Face Recognition Feed</title>
</head>
<body style="text-align: center; background-color: #111; color: #fff;">
    <h1>Live Video Feed</h1>

    <label for="videoSource">Select Video Source:</label>
    <select id="videoSource" onchange="updateFeed()">
        {% for source in video_sources %}
            <option value="{{ source }}">{{ source }}</option>
        {% endfor %}
    </select>

    <br><br>

    <img id="videoFeed" src="/video_feed/{{ video_sources[0] }}" alt="Video Feed" width="640" height="480">

    <script>
        function updateFeed() {
            const sourceName = document.getElementById("videoSource").value;
            document.getElementById("videoFeed").src = `/video_feed/${sourceName}`;
        }
    </script>
</body>
</html>
 -->

<!-- 
 <!DOCTYPE html>
<html>
<head>
  <title>Face Recognition</title>
</head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <input type="hidden" name="grant_type" value="password" />
    <label>Username: <input name="username" required /></label><br />
    <label>Password: <input name="password" type="password" required /></label><br />
    <button type="submit">Get Token</button>
  </form>

  <div id="tokenStatus"></div>

  <hr />

  <h2>Recognize Face</h2>
  <form id="recognizeForm" enctype="multipart/form-data">
    <input type="file" name="image" accept="image/*" required /><br />
    <button type="submit">Recognize Face</button>
  </form>

  <div id="result"></div>

  <script>
    let token = "";

    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const params = new URLSearchParams(formData);

      const response = await fetch("/token", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
        body: params,
      });

      const data = await response.json();
      if (response.ok) {
        token = data.access_token;
        document.getElementById("tokenStatus").innerText = "Token received!";
      } else {
        document.getElementById("tokenStatus").innerText = "Login failed: " + JSON.stringify(data);
      }
    });

    document.getElementById("recognizeForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!token) {
        alert("Please log in first to get token.");
        return;
      }

      const formData = new FormData(e.target);

      const response = await fetch("/recognize_face", {
        method: "POST",
        headers: {
          Authorization: "Bearer " + token,
        },
        body: formData,
      });

      const data = await response.json();
      if (response.ok) {
        document.getElementById("result").innerText = "Face recognized: " + JSON.stringify(data);
      } else {
        document.getElementById("result").innerText = "Failed: " + JSON.stringify(data);
      }
    });
  </script>
</body>
</html> -->